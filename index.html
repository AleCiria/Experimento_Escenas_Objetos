////////////////codigo a la izquierdaaaaaaaaaaaaaaa///////////

//////////////////////////////////////////////
///////// Experimento Tesis Rebe /////////////
//////////////////////////////////////////////

// Claridad del recuerdo = objetos congruentes e incongruentes con el contexto
// Versión jsPsych 7.3.3
// Se usa DataPipe (plugin), GitHub, y OSF
// Fecha 08/10/23
//////////////////////////////////////////////

<!DOCTYPE html>
<html>
  <head>
    <title>Tarea escenas objetos</title>
    <script src="https://unpkg.com/jspsych@7.3.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-fullscreen@1.2.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-instructions@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-call-function@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-animation@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-button-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@1.1.2"></script>
    <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" type="text/css" />
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
    <script type="text/javascript" src="Stim_List_1.js"></script>
    <script type="text/javascript" src="Stim_List_2.js"></script>
    <script type="text/javascript" src="stim_list_P_1.js"></script>
    <script type="text/javascript" src="stim_list_P_2.js"></script>
    <script type="text/javascript" src="stim_list_T_1.js"></script>
    <script type="text/javascript" src="stim_list_T_2.js"></script>
    <script type="text/javascript" src="stim_list_T_3.js"></script>
    <script type="text/javascript" src="stim_list_T_P_1.js"></script>
    <script type="text/javascript" src="stim_list_T_P_2.js"></script>
    <script type="text/javascript" src="stim_list_T_P_3.js"></script>

    <script language="javascript"></script>  
  </head>
  <body></body>
  <script>  


///// Plugins usados /////

// jsPsychHtmlButtonResponse
// jsPsychPreload
// jsPsychFullscreen
// jsPsychSurveyText
// jsPsychSurveyMultiChoice
// jsPsychInstructions
// jsPsychHtmlKeyboardResponse
// jsPsychCallFunction
// jsPsychAnimation
// jsPsychImageKeyboardResponse
// jsPsychImageButtonResponse


var jsPsych = initJsPsych({});

/* Se genera un ID para cada participante de forma aleatoria con 8 caracteres alfanuméricos */
const subject_id = jsPsych.randomization.randomID(8);
jsPsych.data.addProperties({subject_id: subject_id});


var timeline = [];


//se crea el primer ramdom Condition de las opciones para la fase de exposición 
var primer_random = jsPsych.randomization.sampleWithoutReplacement([1, 2], 1)[0];

jsPsych.data.addProperties({condicion_fase_1: primer_random});



//La tarea tarda un poco en cargar, gracias por tu paciencia

var aviso = {
  type: jsPsychHtmlButtonResponse,
  stimulus: '<p><div style ="font-size: 20px;"><strong> La tarea comenzará a cargarse al dar click en el botón de "continuar", esto puede tardar unos segundos. </p><p>Gracias por tu paciencia. </p></strong></div>',
  choices: ['CONTINUAR']
};
timeline.push(aviso);



// Se crea la variable "imagenes" para cargarlas antes del experimento
var instru_imagenes = ["CONSENTIMIENTO.jpg","BIENVENIDA.jpg","INSTRUCCIONES.jpg","INSTRUCCIONES_b_1.jpg","INSTRUCCIONES_b_2.jpg","teclado_1.jpg","instrucciones_b_1.jpg","instrucciones_b_2.jpg","dedos_1.jpg","instrucciones_t.jpg","instrucciones_t_1.jpg","instrucciones_t_2.jpg","instrucciones_t_3.jpg","instrucciones_teclas_1.jpg","instrucciones_teclas_2.jpg","instrucciones_teclas_3.jpg","ejemplo_1.jpg","ejemplo_2.jpg","ejemplo_3.jpg", "teclado_2.jpg","dedos_2.jpg","feedback_t_a.jpg","feedback_t_s.jpg"];

    // Se cargan los elementos de "imagenes" antes de iniciar el experimento
var preload_1 = {
    type: jsPsychPreload,
    images: instru_imagenes
};
timeline.push(preload_1);


// Se crea la variable "imagenes" para cargarlas antes del experimento
var escenas_imagenes = ["airplane_interior_A.jpg","art_gallery_A.jpg","bakery_A.jpg","ballet_room_A.jpg","bar_A.jpg","bedroom_B.jpg","boat_interior_A.jpg","boxing_ring_A.jpg","building_stairs_B.jpg","car_interior_A.jpg","casino_B.jpg",
    "childrens_room_A.jpg","church_B.jpg","classroom_A.jpg","clinic_A.jpg","flower_shop_B.jpg","gymnasium_A.jpg","hair_salon_A.jpg","hospital_room_A.jpg","hotel_lobby_B.jpg","ice_rink_B.jpg","jewelery_A.jpg","kitchen_B.jpg",
    "laboratory_B.jpg","laundry_A.jpg","library_A.jpg","living_room_B.jpg","meeting_room_B.jpg","movie_theater_A.jpg","museum_B.jpg","office_work_B.jpg","orchard_B.jpg","painting_workshop_B.jpg",
    "parking_lot_B.jpg","prison_A.jpg","public_toilet_A.jpg","restaurant_A.jpg","sewing_workshop_B.jpg","shoe_store_A.jpg","shopping_center_B.jpg","theater_A.jpg","vault_A.jpg","waiting_room_A.jpg","warehouse_A.jpg",
    "airplane_interior_A_CON.jpg","art_gallery_A_INC.jpg","bakery_A_CON.jpg","ballet_room_A_INC.jpg","bar_A_CON.jpg","bedroom_B_INC.jpg","boat_interior_A_INC.jpg","boxing_ring_A_CON.jpg","building_stairs_B_CON.jpg",
    "car_interior_A_INC.jpg","casino_B_CON.jpg","childrens_room_A_INC.jpg","church_B_INC.jpg","classroom_A_CON.jpg","clinic_A_CON.jpg","flower_shop_B_CON.jpg","gymnasium_A_CON.jpg","hair_salon_A_CON.jpg","hospital_room_A_INC.jpg",
    "hotel_lobby_B_CON.jpg","ice_rink_B_CON.jpg","jewelery_A_CON.jpg","kitchen_B_CON.jpg","laboratory_B_INC.jpg","laundry_A_INC.jpg","library_A_INC.jpg","living_room_B_INC.jpg","meeting_room_B_CON.jpg","movie_theater_A_INC.jpg",
    "museum_B_INC.jpg","office_work_B_INC.jpg","orchard_B_INC.jpg","painting_workshop_B_CON.jpg","parking_lot_B_INC.jpg","prison_A_INC.jpg","public_toilet_A_CON.jpg","restaurant_A_CON.jpg","sewing_workshop_B_CON.jpg","shoe_store_A_CON.jpg",
    "shopping_center_B_INC.jpg","theater_A_CON.jpg","vault_A_INC.jpg","waiting_room_A_CON.jpg","warehouse_A_INC.jpg","beach_A.jpg","beach_A_CON.jpg","basketball_field_A.jpg","basketball_field_A_INC.jpg",
    "beach_A.jpg","beach_A_CON.jpg","desert_B.jpg","desert_B_INC.jpg","skate_park_B.jpg","skate_park_B_CON.jpg","cemetery_B.jpg","cemetery_B_INC.jpg"];

    // Se cargan los elementos de "imagenes" antes de iniciar el experimento
var preload_2 = {
    type: jsPsychPreload,
    images: escenas_imagenes
};
timeline.push(preload_2);

// Se crea la variable "imagenes" para cargarlas antes del experimento
var objetos_imagenes = ["armchair_SIMILAR.jpg","bikini_SIMILAR.jpg","binoculars_SIMILAR.jpg","bottle_SIMILAR.jpg","boxing_glove_SIMILAR.jpg","clock_SIMILAR.jpg",
    "dice_SIMILAR.jpg","fork_SIMILAR.jpg","grater_SIMILAR.jpg","hairdryer_SIMILAR.jpg","jar_SIMILAR.jpg",
    "jewelry_box_SIMILAR.jpg","poker_chips_SIMILAR.jpg","racket_SIMILAR.jpg","rolling_pin_SIMILAR.jpg","roman_helmet_SIMILAR.jpg",
    "saw_SIMILAR.jpg","scooter_SIMILAR.jpg","tiara_SIMILAR.jpg","weights_SIMILAR.jpg","whelk_SIMILAR.jpg","whistle_SIMILAR.jpg",
    "brocha_NUEVO.jpg","calcetas_NUEVO.jpg","casco_bici_NUEVO.jpg","cepillo_NUEVO.jpg","chupon_NUEVO.jpg","cup_NUEVO.jpg",
    "engrapadora_NUEVO.jpg","googles_NUEVO.jpg","gorra_NUEVO.jpg","guante_cocina_NUEVO.jpg","licuadora_NUEVO.jpg","linterna_NUEVO.jpg",
    "marco_NUEVO.jpg","munieca_NUEVO.jpg","palita_NUEVO.jpg","pandero_NUEVO.jpg","pinzas_NUEVO.jpg","pinia_NUEVO.jpg","silla_NUEVO.jpg",
    "sombrero_NUEVO.jpg","tazon_NUEVO.jpg","vela_NUEVO.jpg",
    "airplane_belt.jpg","appointment_book.jpg","balloons.jpg","beach_umbrella.jpg",
    "blackboard_eraser.jpg","cactus.jpg","chaplet.jpg","color_palette.jpg","dagger.jpg","emergency_exit_signal.jpg","fire_hydrant.jpg",
    "hose.jpg","ice_skates.jpg","luggage_carrier_cart.jpg","magic_cube.jpg","scythe.jpg",
    "shoe_box.jpg","soap_dispenser.jpg","stethoscope.jpg","thimble.jpg","tragedy_mask.jpg","trampoline.jpg","objeto_1.jpg","objeto_2.jpg",
    "objeto_1.jpg","objeto_2.jpg","objeto_3.jpg"];

// Se cargan los elementos de "imagenes" antes de iniciar el experimento
var preload_3 = {
    type: jsPsychPreload,
    images: objetos_imagenes
};
timeline.push(preload_3);



// Pantalla completa
timeline.push({
  type: jsPsychFullscreen,
  message: "<p>Presiona el botón para cambiar a pantalla completa<p>",
  button_label:	'CONTINUAR',
  fullscreen_mode: true
});


//////////////////////////////////////////////////////////////
///////// CONSENTIMIENTO INFORMADO y BIENVENIDA //////////////
/////////////////////////////////////////////////////////////

// Agregar código para presentar la imagen del consentimiento INFORMADO

timeline.push({
  type:jsPsychImageButtonResponse,
  stimulus: "CONSENTIMIENTO.jpg",
  stimulus_height: 650,
  maintain_aspect_ratio: true,
  choices: ["<div style='font-size: 25px;'>ACEPTO</div>"],
});

// Texto de BIENVENIDA al experimento

timeline.push({
  type:jsPsychImageButtonResponse,
  stimulus: "BIENVENIDA.jpg",
  stimulus_height: 600,
  maintain_aspect_ratio: true,
  choices: ["<div style='font-size: 25px;'>CONTINUAR</div>"],
});

//////////////////////////////////////////////
///////// DATOS PARTICIPANTE ////////////////
//////////////////////////////////////////////

var edad = {
  type: jsPsychSurveyText,
  button_label:"CONTINUAR",
  preamble: "<div style='font-size: 20px;'><strong>¿Cuántos años tienes?</strong></div>",
  questions: [
    {
      prompt: 'Por favor, escribe tu edad en números (ejemplo 22)',
      name:'edad',
      required: true,
    },
  ]
};

var genero = {
  type: jsPsychSurveyMultiChoice,
  button_label:"CONTINUAR",
  questions: [
    {
      prompt: "<div style='font-size: 20px;'><strong>¿Con qué género te identificas?</strong></div>", 
      name: 'genero', 
      options: ['FEMENINO', 'MASCULINO', 'OTRO'], 
      required: true,
    }
  ],
};

var nacionalidad = {
  type: jsPsychSurveyText,
  button_label:"CONTINUAR",
  preamble: "<div style='font-size: 20px;'><strong>¿Cuál es tu nacionalidad?</strong></div>",
  questions: [
    {
      prompt: 'Por favor, escribe tu nacionalidad con minúsculas y en femenino (ejemplo: mexicana)',
      name:'nacionalidad',
      required: true,
    },
  ]
};

var escolaridad = {
  type: jsPsychSurveyMultiChoice,
  button_label:"CONTINUAR",
  questions: [
    {
      prompt: "<div style='font-size: 20px;'><strong>¿Cuál es tu grado de escolaridad?</strong> (último grado cursado o cursando actualmente)?</div>", 
      name: 'escolaridad', 
      options: ['PRIMARIA', 'SECUNDARIA', 'BACHILLERATO', 'LICENCIATURA', 'POSGRADO'], 
      required: true,
    }
  ],
};

var vision = {
  type: jsPsychSurveyMultiChoice,
  button_label:"CONTINUAR",
  questions: [
    {
      prompt: "<div style='font-size: 20px;'><p><strong>Indica si tu visión es Normal o Corregida</strong></p><p>Corregida quiere decir que utilizas lentes o lentes de contacto, tuviste alguna operación para corregirla, etc.</p></div>", 
      name: 'vision', 
      options: ['NORMAL', 'CORREGIDA'], 
      required: true,
    }
  ],
};

var color = {
  type: jsPsychSurveyMultiChoice,
  button_label:"CONTINUAR",
  questions: [
    {
      prompt: "<div style='font-size: 20px;'><p><strong> Hasta tu conocimiento, ¿cuentas con alguna condición que pudiera alterar tu percepción de los colores?</strong></p></div>", 
      name: 'vision', 
      options: ['SI', 'NO'], 
      required: true,
    }
  ],
}; 
    
var lateralidad = {
  type: jsPsychSurveyMultiChoice,
  button_label:"CONTINUAR",
  questions: [
    {
      prompt: "<div style='font-size: 20px;'><strong>¿Cuál es tu mano dominante?</strong><p>Es decir la mano con la que escribes</p></div>", 
      name: 'lateralidad', 
      options: ['DERECHA', 'IZQUIERDA', 'AMBAS'], 
      required: true,
    }
  ],
};
timeline.push(edad,genero,nacionalidad,escolaridad,vision,color,lateralidad);


//////////////////////////////////////////////
///////// INICIA FASE DE EXPOSICIÓN ///////////
//////////////////////////////////////////////

// Se presenta una imagen con las INSTRUCCIONES del experimento

var instrucciones_contra;

if (primer_random == 1) {
  instrucciones_contra = "INSTRUCCIONES_b_1.jpg";
} else if (primer_random == 2) {
  instrucciones_contra = "INSTRUCCIONES_b_2.jpg";
}

var instrucciones = {
  type: jsPsychInstructions,
  pages: [
    '<img src="INSTRUCCIONES.jpg" style="width: 950px; height: auto;"></img>',
    '<br>' + 
    '<img src="' + "teclado_1.jpg" + '" style="width: 950px; height: auto;"></img>',
    '<br>' +
    '<img src="' + instrucciones_contra + '" style="width: 950px; height: auto;"></img>'
  ],
  button_label_next: "CONTINUAR",
  button_label_previous: "ANTERIOR",
  show_clickable_nav: true,
  allow_keys: false
};

var inicio_practica = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: '<div style="font-size:25px;"><strong>Coloca tus dedos sobre las teclas “V” y “N”,</p><p>cuando estés list@, presiona cualquiera de ellas para comenzar la práctica :)</p> </strong></div>',
  choices: ["v","n"]
};
timeline.push(instrucciones,inicio_practica);


//////Estimulos de práctica con retroalimentación///////////

//Quitar cursor utilizando un estilo css cargado como "no_mouse.css"
var cursor_off= {
  type: jsPsychCallFunction,
  func: function(){
    document.body.style.cursor = "none";
  }
};
timeline.push(cursor_off);

// Cruz de fijación
var fixation = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: '<div style="font-size:80px;color:red;">+</div>',
  choices: "NO_KEYS",
  trial_duration: 600
};

var practica = {
  type: jsPsychAnimation,
  stimuli: jsPsych.timelineVariable('stimulus'),
  frame_time: 1500,
  choices: "NO_KEYS",
  render_on_canvas: true
};

// Definir texto_practica dependiendo de primer_random
var texto_practica;

if (primer_random == 1) {
  texto_practica = "<p><strong>CONGRUENTE</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>INCONGRUENTE</strong></p>"; Stim_List_P = Stim_List_P_1;
} else if (primer_random == 2) {
  texto_practica = "<p><strong>INCONGRUENTE</strong>&nbsp;&nbsp;&nbsp;<strong>CONGRUENTE</strong></p>" ; Stim_List_P = Stim_List_P_2
}

// Crear un procedimiento que repita la secuencia de estímulos
var procedimiento_practica = {
  timeline: [fixation, practica],
  timeline_variables: Stim_List_P,
  randomize_order: true,
};

const save_data = {
  type: jsPsychPipe,
  action: "save",
  experiment_id: "Uh1IVajIV2t7",
  filename: `${subject_id}.csv`,
  data_string: ()=>jsPsych.data.get().csv()
};
timeline.push(save_data);



jsPsych.run(timeline);

  </script>
</html>
